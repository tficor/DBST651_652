--- 1 ---

SELECT *
FROM ORDERS;

--- 2 ---

SELECT EMPLOYEE_ID, EMPLOYEE_LASTNAME, EMPLOYEE_FIRSTNAME, USER_ID, DEPARTMENT
FROM EMPLOYEE;

--- 3 ---

select ORDER_NUM, SUBMIT_DATE, ITEM_ID, QUANTITY, STATUS, CATALOG_NUM, PRICE
from ORDERS_PLACED;

--- 4 ---

SELECT ITEM.ITEM_ID,
  ITEM.MANUFACTURER,
  ITEM.VENDOR_CATALOG_NUM,
  ITEM.CATALOG_NUM,
  ITEM.PRICE,
  ITEM.SAP,
  ITEM.VENDOR_ID,
  ITEM.EXPIRATION,
  VENDOR.VENDOR_ID AS VENDOR_ID1,
  VENDOR.VENDOR_NAME,
  VENDOR.ACCOUNT_REPRESENTATIVE,
  VENDOR.CATEGORY_ID,
  VENDOR.VENDOR_PHONE,
  VENDOR.VENDOR_ADDRESS,
  VENDOR.VENDOR_COUNTRY
FROM ITEM
INNER JOIN VENDOR
ON VENDOR.VENDOR_ID = ITEM.VENDOR_ID;

--- 5 ---

SELECT ORDERS.ORDER_NUM,
  ORDERS.SUBMIT_DATE,
  ORDERS.QUANTITY,
  ORDERS.STATUS,
  ORDERS.COST_CENTER,
  ORDERS.USER_ID,
  ORDERS.CATALOG_NUM,
  ORDERS.ITEM_ID,
  ORDERS.SECTION_ID
FROM ORDERS
ORDER BY ORDERS.STATUS

--- 6 ---

SELECT ITEM.ITEM_ID,
  ORDERS.USER_ID,
  PURCHASING.REQ_NUM,
  ORDERS.SUBMIT_DATE,
  ITEM.SAP
FROM PURCHASING
LEFT OUTER JOIN ORDERS
ON ORDERS.ORDER_NUM = PURCHASING.ORDER_NUM
RIGHT OUTER JOIN ITEM
ON ITEM.ITEM_ID = ORDERS.ITEM_ID
FETCH FIRST 10 ROWS ONLY;

--- 7 ---

SELECT DISTINCT
  ITEM.ITEM_ID,
  ORDERS.USER_ID,
  PURCHASING.REQ_NUM,
  ORDERS.SUBMIT_DATE,
  ITEM.SAP
FROM PURCHASING
LEFT OUTER JOIN ORDERS
ON ORDERS.ORDER_NUM = PURCHASING.ORDER_NUM
RIGHT OUTER JOIN ITEM
ON ITEM.ITEM_ID = ORDERS.ITEM_ID;

--- 8 ---

SELECT ORDERS.ORDER_NUM,
  EMPLOYEE.USER_ID,
  ORDERS.QUANTITY
FROM ORDERS,
  EMPLOYEE
GROUP BY ORDERS.ORDER_NUM,
  EMPLOYEE.USER_ID,
  ORDERS.USER_ID,
  ORDERS.QUANTITY
HAVING ORDERS.QUANTITY = 2;

--- 9 ---

SELECT * FROM VENDOR
WHERE VENDOR_COUNTRY IN ('USA');

--- 10 --

SELECT LENGTH(EMPLOYEE.USER_ID)
FROM EMPLOYEE;

--- 11 --

SELECT * FROM ORDERS;

DELETE FROM ORDERS
WHERE ORDER_NUM = '1000';

SELECT * FROM ORDERS;

ROLLBACK;

SELECT * FROM ORDERS;

--- 12 --

SELECT * FROM ORDERS;

UPDATE ORDERS
SET STATUS = 'Delivered'
WHERE ORDER_NUM = 1002;

SELECT * FROM ORDERS;

ROLLBACK;

SELECT * FROM ORDERS;

--- ADVANCED QUERIES ---

UPDATE EMPLOYEE
SET EMPLOYEE.SECTION_ID = 'TC'
WHERE EMPLOYEE_ID = '15200';

SELECT EMPLOYEE.EMPLOYEE_ID,
  EMPLOYEE.SECTION_ID,
  ORDERS.ORDER_NUM
FROM EMPLOYEE,ORDERS
ORDER BY EMPLOYEE.EMPLOYEE_ID;
  
ROLLBACK;

SELECT EMPLOYEE.EMPLOYEE_ID,
  EMPLOYEE.SECTION_ID,
  ORDERS.ORDER_NUM
FROM EMPLOYEE,ORDERS
ORDER BY EMPLOYEE.EMPLOYEE_ID;

-------------------------

SELECT ORDERS.ORDER_NUM, ORDERS.USER_ID,
  SUM(ORDERS.QUANTITY * ITEM.PRICE) AS SUM
FROM ITEM, ORDERS
GROUP BY ORDERS.ORDER_NUM, ORDERS.USER_ID;

-------------------------

SELECT DISTINCT EMPLOYEE.EMPLOYEE_ID, 
  HOSPITAL.HOSPITAL_NAME,
  HOSPITAL.HOSPITAL_PHONE,
  EMPLOYEE.EMPLOYEE_EXTENSION
FROM HOSPITAL,
  EMPLOYEE
WHERE EMPLOYEE.EMPLOYEE_EXTENSION = '5393'

-------------------------

SELECT PURCHASING.REQ_NUM,
  PURCHASING.VENDOR_ID,
  PURCHASING.PROCESSING_DATE,
  VENDOR.CATEGORY_ID
FROM PURCHASING
INNER JOIN VENDOR
ON VENDOR.VENDOR_ID              = PURCHASING.VENDOR_ID
WHERE PURCHASING.PROCESSING_DATE = '4/2/2019'
GROUP BY PURCHASING.REQ_NUM,
  PURCHASING.VENDOR_ID,
  PURCHASING.PROCESSING_DATE,
  VENDOR.CATEGORY_ID
ORDER BY PURCHASING.REQ_NUM;

-------------------------

SELECT EMPLOYEE.EMPLOYEE_LASTNAME,
  EMPLOYEE.EMPLOYEE_ID,
  EMPLOYEE.EMPLOYEE_FIRSTNAME
FROM EMPLOYEE
WHERE EMPLOYEE_ID = 15203 OR EMPLOYEE_LASTNAME = 'darcy';

-------------------------

SELECT DISTINCT REPRESENTATIVE.REP_ID,
  PURCHASING.VENDOR_ID,
  REPRESENTATIVE.LASTNAME,
  REPRESENTATIVE.FIRSTNAME
FROM PURCHASING,
  REPRESENTATIVE
WHERE REPRESENTATIVE.REP_ID LIKE '400';

-------------------------

SELECT HOSPITAL.HOSPITAL_ID,
  COUNT(DISTINCT VENDOR.VENDOR_ID) AS Count_VENDOR_ID,
  SUM(REPRESENTATIVE.REP_ID)       AS Sum_REP_ID,
  REPRESENTATIVE.FIRSTNAME,
  REPRESENTATIVE.LASTNAME
FROM VENDOR
INNER JOIN REPRESENTATIVE
ON VENDOR.VENDOR_ID = REPRESENTATIVE.VENDOR_ID,
  HOSPITAL
GROUP BY HOSPITAL.HOSPITAL_ID,
  REPRESENTATIVE.FIRSTNAME,
  REPRESENTATIVE.LASTNAME;

--------------------------

SELECT COUNT(ITEM.ITEM_ID) AS Count_ITEM_ID,
  AVG(ITEM.PRICE)          AS Avg_PRICE,
  SUM(ORDERS.QUANTITY)     AS Sum_QUANTITY
FROM ITEM
INNER JOIN ORDERS
ON ITEM.ITEM_ID = ORDERS.ITEM_ID;

--------------------------

SELECT PURCHASE_ORDER_NUM
FROM PURCHASING;

UPDATE PURCHASING
SET PURCHASE_ORDER_NUM = 4005002136
WHERE PURCHASE_ORDER_NUM IS NULL;

SELECT PURCHASE_ORDER_NUM
FROM PURCHASING;

ROLLBACK;